\documentclass[../../slides]{subfiles}

\begin{document}
    \begin{tikzpicture}[
            edge from parent path={(\tikzparentnode.south) -- ++(0,-.5ex) -| (\tikzchildnode.north)},
            every path/.style={line width=.2ex},
            level distance=4.5ex,
            node distance=4ex,
            anchor=center,
            level 1/.style={sibling distance=1.5em},
            level 2/.style={sibling distance=2em},
            level 3/.style={sibling distance=20em},
            every node/.style={font=\small},
            remember picture
        ]
        \visible<3->{
            \matrix (pos) [matrix of nodes, every node/.style={anchor=center, inner sep=0pt, font=\strut, minimum height=12pt}, column sep=6pt, ampersand replacement=\&] {
                |[font=\scriptsize]| WH+WRB \& PT \& NN \& VBD \& VBN \& |[font=\scriptsize]| {PRT+RP} \\
                where \& the  \& survey     \& was \& carried     \& out   \\
            };
        }

        \node[above=17ex of pos, xshift=-8ex] (sbar) {SBAR+S}
            child { node[] (vp1) {VP}
                child { node[] (vp2) {VP}
                    child { node[above=0ex of pos-1-1] (wrb) {1}}
                    child { node[xshift=1ex] (vpbin) {VP\(^B\)}
                        child { node[above=0ex of pos-1-5] (term4) {5} }
                        child { node[above=0ex of pos-1-6] (prt) {6} }}}
                child { node[above=0ex of pos-1-4] (term3) {4} }}
            child { node[yshift=-9ex] (np) {NP}
                child { node[above=0ex of pos-1-2] {2} }
                child { node[above=0ex of pos-1-3] (term2) {3} }};

        % redraw corssing edges with white foundation
        \begin{scope}[draw]
            \draw[white, line width=1ex] (vp1.south) -- ++(0,-.5ex) -| (term3.north);
            \draw (vp1.south) -- ++(0,-.5ex) -| (term3.north);
            %        \draw[densely dotted, white] (vp1.south) -- ++(0,-.7ex) -| (term3.north);
            \draw (vp1.south) -- ++(0,-.5ex) -| (vp2.north);

            \draw[white, line width=1ex] (sbar.south) -- ++(0,-.7ex) -| (np.north);
            \draw (sbar.south) -- ++(0,-.5ex) -| (np.north);
            \draw (sbar.south) -- ++(0,-.5ex) -| (vp1.north);
        \end{scope}

        % overwrite bottom layer in the first two overlays
        \visible<-2>{
            \node[fill=white, fit=(pos) (wrb), inner sep=0pt, outer sep=0pt] {};
            \matrix (phantompos) [matrix of nodes, every node/.style={anchor=center, inner sep=0pt, font=\strut, minimum height=12pt}, column sep=6pt, ampersand replacement=\&, yshift=12pt] {
                |[font=\scriptsize]| WH+WRB \& PT \& NN \& VBD \& VBN \& |[font=\scriptsize]| {PRT+RP} \\
                where \& the  \& survey     \& was \& carried     \& out   \\
            };
        }
    \end{tikzpicture}
\end{document}